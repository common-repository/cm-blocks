(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var a in s)e.o(s,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.i18n,s=window.wp.data,a=window.wp.plugins,o=window.wp.blockEditor,l=window.wp.components,r=window.wp.element,n=async(e,t="https://patterns.cmblocks.com/wp-json/wp")=>{const s=(()=>{const e=Math.floor(11*Math.random());let t="";for(let s=0;s<13;s++)t+=s===e?"cm":"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(52*Math.random())];return t})();try{const a=await fetch(`${t}/${e}`,{method:"GET",headers:{"CMBlocks-Plugin-Token":s}}),o=await a.json();if(o.status&&403===o.status)return new Error("Token verification error");return{totalPages:a.headers.get("X-WP-TotalPages"),totalPosts:a.headers.get("X-WP-Total"),responseData:o}}catch(e){return console.error(__("Token verification error:","cm-blocks"),e),e}},c=async e=>{try{const{responseData:t}=await n(e);return t.map((e=>{var t;return{name:e.slug,label:e.name,categoryID:null!==(t=e.id)&&void 0!==t?t:e.term_id}}))}catch(e){throw console.error("Error fetching WordPress categories:",e),e}},i=window.ReactJSXRuntime,p=(0,r.createContext)(),d=({children:e})=>{const[t,s]=(0,r.useState)([]),a=()=>{(()=>{const e=new URLSearchParams;return e.append("action","get_favorite_patterns"),e.append("nonce",importerData.ajaxNonce),fetch("/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then((e=>e.json())).then((e=>e.success?e.data:[])).catch((e=>{throw console.error("Error fetching favorite patterns:",e),e}))})().then((e=>{s(e)}))};return(0,r.useEffect)((()=>{a()}),[]),(0,i.jsx)(p.Provider,{value:{syncFavorites:a,myFavorites:t},children:e})},m=()=>(0,r.useContext)(p),u=({id:e,premium:t,title:s,type:a,featured_image_url:o,activeTab:l,onClickPattern:n,pattern:c})=>{const[p,d]=(0,r.useState)(486),[u,h]=(0,r.useState)(!1),_=()=>{window.innerWidth},{myFavorites:g,syncFavorites:k}=m();(0,r.useEffect)((()=>{g.some((t=>t.object_id===String(e)))&&h(!0)}),[g]);return(0,r.useEffect)((()=>{_(),window.addEventListener("resize",_)}),[]),(0,i.jsxs)("div",{className:"cmblocks-popup__modal-pattern-preview-card-item",onClick:()=>n(c),onMouseOver:e=>{if("page"!==l)return;const t=e.currentTarget,s=t.querySelector(".cmblocks-popup__modal-pattern-preview-card-thumbnail>img");if(s){const e=s.clientHeight-p;s.closest(".cmblocks-popup__modal-pattern-preview-card-thumbnail")&&(e>0&&(s.style.transform=`translateY(-${e}px)`),t.addEventListener("mouseout",(()=>{s.style.transform=null}),{once:!0}))}},children:[(0,i.jsx)("div",{className:"cmblocks-popup__modal-pattern-favorite-button  "+(u?"cmblocks-popup__modal-pattern-favorite-button--is-favorite":""),onClick:t=>{t.stopPropagation(),(()=>{const t=u?"delete":"save";h((e=>!e)),((e,t,s,a)=>{const o=new URLSearchParams;return o.append("action","save"===e?"save_favorite_pattern":"delete_favorite_pattern"),o.append("object_id",t),o.append("type",s),o.append("nonce",a),fetch("/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then((e=>e.json())).then((e=>e)).catch((e=>{throw console.error("Error performing operation:",e),e}))})(t,e,a,importerData.ajaxNonce).then((e=>(k(),e))).catch((e=>{console.error(`Error ${u?"saving":"deleting"} favorite pattern:`,e)}))})()},children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fill:"currentColor",d:"M10 17.12c3.33-1.4 5.74-3.79 7.04-6.21c1.28-2.41 1.46-4.81.32-6.25c-1.03-1.29-2.37-1.78-3.73-1.74s-2.68.63-3.63 1.46c-.95-.83-2.27-1.42-3.63-1.46s-2.7.45-3.73 1.74c-1.14 1.44-.96 3.84.34 6.25c1.28 2.42 3.69 4.81 7.02 6.21"})})}),t&&(0,i.jsx)("div",{className:"cmblocks-popup__modal-pro-banner-wrapper",children:(0,i.jsxs)("span",{className:"cmblocks-popup__modal-pro-banner",children:["Pro",(0,i.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.546 6.545c0 .992-.568 1.851-1.395 2.272 1.304 3.493 2.67 5.21 3.871 5.344 1.35.152 2.586-.47 3.796-2.004a1.23 1.23 0 0 1 .512-.39A2.545 2.545 0 1 1 27 12.869c.002.112-.01.23-.04.353l-1.981 7.981A3.67 3.67 0 0 1 21.423 24H10.577a3.67 3.67 0 0 1-3.556-2.797l-1.98-7.981a1.329 1.329 0 0 1-.04-.353 2.545 2.545 0 1 1 1.67-1.102c.193.076.376.21.527.41 1.152 1.525 2.375 2.142 3.78 1.984 1.259-.14 2.618-1.852 3.872-5.344a2.545 2.545 0 1 1 3.696-2.272ZM7 27.25c0-.69.56-1.25 1.25-1.25h15.5a1.25 1.25 0 1 1 0 2.5H8.25c-.69 0-1.25-.56-1.25-1.25Z",fill:"currentColor"})})]})}),(0,i.jsx)("div",{className:"cmblocks-popup__modal-pattern-preview-card-thumbnail",children:o?(0,i.jsx)("img",{src:o,alt:s}):(0,i.jsx)("div",{className:"cmblocks-popup__modal-pattern-preview-card-alternate",children:"No Image"})}),(0,i.jsx)("div",{className:"cmblocks-popup__modal-pattern-preview-card-title",children:s})]})},h=({patterns:e,onClickPattern:t,activeTab:s,isLoading:a})=>(0,i.jsx)("div",{className:"cmblocks-popup__modal-pattern-preview-card-list "+("page"===s?"cmblocks-popup__modal-pattern-preview-card-list--is-active-page":""),style:{display:a?"none":""},children:e.map(((e,a)=>(0,i.jsx)(u,{pattern:e,activeTab:s,id:e.id,type:e.type,title:e.title,premium:e.premium,featured_image_url:e.feature_image_url,onClickPattern:t},a)))});function _({totalPosts:e,totalPages:s,currentPage:a,onPageChange:o}){const[n,c]=(0,r.useState)(a),p=e=>{o(e)};return(0,i.jsxs)("div",{className:"cmblocks-popup__modal-pagination",children:[(0,i.jsxs)("div",{className:"cmblocks-popup__modal-pagination-total-items",children:[e," ",(0,t.__)("items","cm-blocks")]}),(0,i.jsx)(l.Button,{isPrimary:!0,onClick:()=>{a>1&&p(a-1)},disabled:1===a,children:(0,i.jsx)(l.Dashicon,{icon:"arrow-left-alt"})}),(0,i.jsxs)("span",{className:"page-number",children:[a,"/",s]}),(0,i.jsx)(l.Button,{isPrimary:!0,onClick:()=>{a<s&&p(a+1)},disabled:a===parseInt(s),children:(0,i.jsx)(l.Dashicon,{icon:"arrow-right-alt"})})]})}const g=({message:e})=>(0,i.jsxs)("div",{className:"access-denied-message",children:[(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M22.2 17.6334L14.0016 3.39563C13.7967 3.04681 13.5042 2.75758 13.1531 2.55662C12.802 2.35566 12.4045 2.24994 12 2.24994C11.5955 2.24994 11.198 2.35566 10.8469 2.55662C10.4958 2.75758 10.2033 3.04681 9.99844 3.39563L1.8 17.6334C1.60288 17.9708 1.49899 18.3546 1.49899 18.7453C1.49899 19.1361 1.60288 19.5198 1.8 19.8572C2.00225 20.2081 2.29422 20.4989 2.64596 20.6997C2.99771 20.9006 3.39655 21.0042 3.80156 21H20.1984C20.6031 21.0039 21.0016 20.9001 21.353 20.6993C21.7044 20.4985 21.996 20.2078 22.1981 19.8572C22.3955 19.52 22.4997 19.1363 22.5001 18.7456C22.5004 18.3548 22.3968 17.971 22.2 17.6334ZM20.8997 19.1063C20.8282 19.2282 20.7256 19.3289 20.6024 19.3981C20.4792 19.4673 20.3397 19.5024 20.1984 19.5H3.80156C3.66026 19.5024 3.52085 19.4673 3.39762 19.3981C3.27439 19.3289 3.17179 19.2282 3.10031 19.1063C3.03557 18.9966 3.00142 18.8717 3.00142 18.7444C3.00142 18.6171 3.03557 18.4921 3.10031 18.3825L11.2988 4.14469C11.3717 4.02335 11.4747 3.92295 11.598 3.85324C11.7212 3.78354 11.8603 3.7469 12.0019 3.7469C12.1434 3.7469 12.2826 3.78354 12.4058 3.85324C12.529 3.92295 12.6321 4.02335 12.705 4.14469L20.9034 18.3825C20.9676 18.4924 21.0011 18.6176 21.0005 18.7449C20.9998 18.8722 20.965 18.997 20.8997 19.1063ZM11.25 13.5V9.75C11.25 9.55109 11.329 9.36032 11.4697 9.21967C11.6103 9.07902 11.8011 9 12 9C12.1989 9 12.3897 9.07902 12.5303 9.21967C12.671 9.36032 12.75 9.55109 12.75 9.75V13.5C12.75 13.6989 12.671 13.8897 12.5303 14.0303C12.3897 14.171 12.1989 14.25 12 14.25C11.8011 14.25 11.6103 14.171 11.4697 14.0303C11.329 13.8897 11.25 13.6989 11.25 13.5ZM13.125 16.875C13.125 17.0975 13.059 17.315 12.9354 17.5C12.8118 17.685 12.6361 17.8292 12.4305 17.9144C12.225 17.9995 11.9988 18.0218 11.7805 17.9784C11.5623 17.935 11.3618 17.8278 11.2045 17.6705C11.0472 17.5132 10.94 17.3127 10.8966 17.0945C10.8532 16.8762 10.8755 16.65 10.9606 16.4445C11.0458 16.2389 11.19 16.0632 11.375 15.9396C11.56 15.816 11.7775 15.75 12 15.75C12.2984 15.75 12.5845 15.8685 12.7955 16.0795C13.0065 16.2905 13.125 16.5766 13.125 16.875Z",fill:"#EE1A1A"})}),(0,i.jsx)("span",{children:e})]}),k=({onRefreshClick:e})=>(0,i.jsx)("div",{className:"cmblocks-popup__modal-patterns-refresher",children:(0,i.jsx)("div",{className:"cmblocks-popup__modal-patterns-refresher-icon",onClick:e,children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6",children:[(0,i.jsx)("title",{children:(0,t.__)("Refresh","cm-blocks")}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})]})})}),b=({patterns:e,onClickPattern:s,title:a,isPremium:o,isValidLicense:n,description:c})=>{const p=(0,r.useRef)(null),[d,m]=(0,r.useState)(0);return(0,i.jsxs)("div",{className:"cmblocks-popup__modal-kits-wrapper",children:[(0,i.jsx)("div",{className:"cmblocks-popup__modal-kits-title",children:a}),(0,i.jsxs)("div",{className:"cmblocks-popup__modal-kits-content",children:[(0,i.jsx)("div",{className:"cmblocks-popup__modal-kits-preview-area",children:(0,i.jsxs)("div",{className:"cmblocks-popup__modal-kits-preview-img",ref:p,children:[o&&(0,i.jsx)("div",{className:"cmblocks-popup__modal-pro-banner-wrapper cmblocks-popup__modal-kits-pro-banner-wrapper",children:(0,i.jsxs)("span",{className:"cmblocks-popup__modal-pro-banner",children:["Pro",(0,i.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.546 6.545c0 .992-.568 1.851-1.395 2.272 1.304 3.493 2.67 5.21 3.871 5.344 1.35.152 2.586-.47 3.796-2.004a1.23 1.23 0 0 1 .512-.39A2.545 2.545 0 1 1 27 12.869c.002.112-.01.23-.04.353l-1.981 7.981A3.67 3.67 0 0 1 21.423 24H10.577a3.67 3.67 0 0 1-3.556-2.797l-1.98-7.981a1.329 1.329 0 0 1-.04-.353 2.545 2.545 0 1 1 1.67-1.102c.193.076.376.21.527.41 1.152 1.525 2.375 2.142 3.78 1.984 1.259-.14 2.618-1.852 3.872-5.344a2.545 2.545 0 1 1 3.696-2.272ZM7 27.25c0-.69.56-1.25 1.25-1.25h15.5a1.25 1.25 0 1 1 0 2.5H8.25c-.69 0-1.25-.56-1.25-1.25Z",fill:"currentColor"})})]})}),null!==d?(0,i.jsx)("img",{src:e[d].feature_image_url,alt:e[d].title}):(0,i.jsx)("div",{children:"No pattern selected"})]})}),(0,i.jsxs)("div",{className:"cmblocks-popup__modal-kits-select-area",children:[(0,i.jsx)("div",{className:"cmblocks-popup__modal-kits-list",children:e.map(((e,s)=>(0,i.jsxs)("div",{className:"cmblocks-popup__modal-kits-item "+(d===s?"is-selected":""),onClick:()=>(e=>{null===d&&m(0),m(e),p.current&&(p.current.scrollTop=0)})(s),children:[(0,i.jsx)("div",{className:"cmblocks-popup__modal-kits-item-image-preview",children:e.feature_image_url?(0,i.jsx)("img",{src:e.feature_image_url,alt:e.title}):(0,i.jsx)("div",{className:"cmblocks-popup__modal-pattern-list-alternate",children:(0,t.__)("No Image","cm-blocks")})}),(0,i.jsx)("div",{className:"cmblocks-popup__modal-kits-item-title",children:e.title})]},s)))}),(0,i.jsxs)("div",{className:"cmblocks-popup__modal-kits-button-group",children:[(0,i.jsxs)(l.Button,{onClick:()=>{if(null!==d){const t=e[d].demo_link;window.open(t,"_blank")}},children:[(0,t.__)("Preview","cm-blocks"),(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:[(0,i.jsx)("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),(0,i.jsx)("path",{fillRule:"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z",clipRule:"evenodd"})]})]}),(0,i.jsxs)(l.Button,{onClick:()=>{null!==d&&s(e[d])},children:["invalid"===n&&o?(0,t.__)("Buy Pro","cm-blocks"):(0,t.__)("Import","cm-blocks"),(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})})]})]})]})]}),(0,i.jsx)("div",{className:"cmblocks-popup__modal-kits-description",children:c})]})},v=({onGoBackClick:e})=>(0,i.jsx)("div",{className:"cmblocks-popup__modal-patterns-go-back",children:(0,i.jsx)("div",{className:"cmblocks-popup__modal-patterns-go-back-icon",onClick:e,children:(0,i.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"512.000000pt",height:"512.000000pt",viewBox:"0 0 512.000000 512.000000",preserveAspectRatio:"xMidYMid meet",children:(0,i.jsxs)("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:"#000000",stroke:"none",children:[(0,i.jsx)("title",{children:(0,t.__)("Back","cm-blocks")}),(0,i.jsx)("path",{d:"M3305 4411 c-57 -27 -1748 -1722 -1770 -1773 -20 -50 -19 -114 4 -163 27 -57 1722 -1748 1773 -1770 109 -45 246 21 277 132 15 51 14 566 0 618 -9 34 -89 118 -542 573 l-532 532 527 528 c365 364 532 538 543 564 12 31 15 89 15 325 0 259 -2 292 -19 328 -49 106 -174 154 -276 106z"})]})})})}),w=({selectedCategory:e,categories:s,onCategoryChange:a})=>{const o="block-editor-block-patterns-explorer__sidebar";return(0,i.jsx)("div",{className:`${o}__categories-list`,children:s.map((({name:s,label:r,categoryID:n})=>(0,i.jsx)(l.Button,{label:(0,t.__)("label","cm-blocks"),className:`${o}__categories-list__item`,isPressed:e===s,onClick:()=>{a(s,n)},children:r},s)))})},x=({selectedCategory:e,onCategoryChange:s})=>{const a="block-editor-block-patterns-explorer__sidebar";return(0,i.jsx)("div",{className:`${a}__categories-list`,children:[{name:"all",label:"All"},{name:"business",label:"Business"},{name:"blog",label:"Blog"},{name:"portfolio",label:"Portfolio"}].map((({name:o,label:r})=>(0,i.jsx)(l.Button,{label:(0,t.__)("label","cm-blocks"),className:`${a}__categories-list__item`,isPressed:e===o,onClick:()=>{s(o)},children:r},o)))})},C=({handleFilterChange:e,handleSearchChange:s,handleTabChange:a,handleCategoryChange:o,searchValue:r,selectedCategory:n,categories:c,isKits:p})=>{const d={display:p?"none":"block"};return(0,i.jsxs)("div",{className:"cmblocks-popup__modal-sidebar",style:d,children:[(0,i.jsx)("div",{className:"cmblocks-popup__modal-sidebar-toggle-option",children:(0,i.jsxs)(l.__experimentalToggleGroupControl,{label:(0,t.__)("","cm-blocks"),onChange:t=>e(t),value:"all",children:[(0,i.jsx)(l.__experimentalToggleGroupControlOption,{label:(0,t.__)("All","cm-blocks"),value:"all"}),(0,i.jsx)(l.__experimentalToggleGroupControlOption,{label:(0,t.__)("Pro","cm-blocks"),value:"pro"})]})}),(0,i.jsx)("div",{className:"cmblocks-popup__modal-sidebar-search-bar",children:(0,i.jsx)(l.SearchControl,{__nextHasNoMarginBottom:!0,onChange:s,value:r,label:(0,t.__)("Search for patterns","cm-blocks"),placeholder:(0,t.__)("Search","cm-blocks")})}),(0,i.jsx)(l.TabPanel,{className:"cmblocks-popup__modal-sidebar-title-list",activeClass:"is-active",onSelect:a,tabs:[{name:"patterns",title:(0,t.__)("Patterns","cm-blocks"),className:"patterns"},{name:"page",title:(0,t.__)("Page","cm-blocks"),className:"page"},{name:"kits",title:(0,t.__)("Kits","cm-blocks"),className:"kits"}],children:({name:e})=>"kits"===e?(0,i.jsx)(x,{onCategoryChange:o,selectedCategory:n}):(0,i.jsx)(w,{selectedCategory:n,categories:c,onCategoryChange:o})})]})},f=({onClickFavoriteButton:e})=>(0,i.jsx)(l.Button,{className:"cmblocks-popup__modal-favorite-button",onClick:e,children:(0,t.__)("Favorites","cm-blocks")}),j=({label:e,options:s,onChange:a,value:o,className:r})=>(0,i.jsx)("div",{className:`cmblocks-popup__modal-tab-${r}`,children:(0,i.jsx)(l.__experimentalToggleGroupControl,{label:(0,t.__)(e,"cm-blocks"),onChange:a,value:o,children:s.map((e=>(0,i.jsx)(l.__experimentalToggleGroupControlOption,{label:(0,t.__)(e.label,"cm-blocks"),value:e.value},e.value)))})}),y=window.wp.blocks,P=window.wp.apiFetch;var N=e.n(P);const H=window.lodash,M=(e,s,a,o,l,r,n,c,i,p,d,m,u,h,_)=>{if(o(!0),a((0,t.__)("Importing Content...","cmblocks")),e.premium&&"valid"!==r)return window.open("https://cmblocks.com/pricing/","_blank"),a((0,t.__)("Loading Content","cm-blocks")),void o(!1);const g=new FormData;g.append("action","process_pattern_handler"),g.append("pattern_content",e.content),g.append("nonce",importerData.ajaxNonce),n(importerData.ajaxURL,{method:"POST",body:g}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return o(!0),e.json()})).then((t=>{e={...e,content:t};let a=document.createElement("div");a.innerHTML=e.content;let o=a.querySelector(".cmblocks-popup__modal-pro-banner-wrapper");if(o&&(o.parentNode.removeChild(o),e.content=a.innerHTML),s=u({HTML:e.content,mode:"BLOCKS"}),null===h)c(s);else if(null!==_){const e=d("core/editor").getBlock(_);null!==e&&m(e)?i(_,s):c(s,h)}p()})).catch((e=>{console.error("Error:",e)})).finally((()=>{o(!1)}))};function S({icon:e,index:a,selectedBlockID:p=null,modalTile:d,closeModal:u,isModalOpen:w}){const{insertBlocks:x}=(0,s.useDispatch)(o.store),P=(0,r.useRef)(),[S,V]=(0,r.useState)(!1),[T,B]=(0,r.useState)(!1),[E,R]=(0,r.useState)(1),[Z,L]=(0,r.useState)(0),[$,D]=(0,r.useState)([]),[A,O]=(0,r.useState)("all"),[F,I]=(0,r.useState)(""),[W,G]=(0,r.useState)(),[q,K]=(0,r.useState)(0),[U,z]=(0,r.useState)("patterns"),[X,Y]=(0,r.useState)("all"),[J,Q]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(""),[se,ae]=(0,r.useState)(!1),{themePatterns:oe,themePagePatterns:le}=(0,s.useSelect)((e=>{const{getPatternsByBlockTypes:t}=e(o.store);return{themePatterns:t("codemanas/theme"),themePagePatterns:t("codemanas/page")}}),[]),{replaceBlock:re}=(0,s.useDispatch)(o.store),ne=[{name:"all",label:(0,t.__)("All","cm-blocks")}],[ce,ie]=(0,r.useState)([]),[pe,de]=(0,r.useState)([]),[me,ue]=(0,r.useState)([]),[he,_e]=(0,r.useState)((0,t.__)("Loading Content","cm-blocks")),[ge,ke]=(0,r.useState)(!1),[be,ve]=(0,r.useState)(""),[we,xe]=(0,r.useState)(""),[Ce,fe]=(0,r.useState)(!1),[je,ye]=(0,r.useState)(!1),{myFavorites:Pe}=m(),Ne=`cmblocks-popup__modal-patterns block-editor-block-patterns-explorer${ge?" cmblocks-popup__modal-patterns--is-active-kits":""} ${je?" cmblocks-popup__modal-patterns--is-active-favorite":""}`,He=(e,t)=>{let s;return void 0!==t&&t.length,s=[...ne,...e],s},Me=e=>{z(e),O("all"),R(1),G(null),ke(!1)},Se=e=>{const t=((e,t)=>{const s=6*(t-1),a=s+6;return e.slice(s,a)})(e,E);"all"===X?(D(t),K(e.length),L(Math.ceil(e.length/6)),F&&(e=>{const t=e.filter((e=>e.title.toLowerCase().includes(F)));D(t),K(t.length),L(Math.ceil(t.length/6))})(e)):D([])},Ve=async(e,s=E,a=!1,o="",l="all",r=!1,c=null)=>{V(!0);const i=((e,t,s,a,o,l,r=!1,n=[])=>{let c=`${e}?per_page=${r?50:6}&page=${t}`;return s&&(c+=`&categories=${s}`),a&&(c+=`&search=${a}&search_fields=title`),r&&(c+=`&kits=${s}`),c+=`&filter_by=${"pro"===o?o:"all"}`,n.length>0&&(c+=`&include=${n.join(",")}`),c})(`v2/${e}`,s,a,o,l,0,r,c);try{const{totalPages:e,totalPosts:s,responseData:a}=await(async e=>{try{const{totalPages:t,totalPosts:s,responseData:a}=await n(e);return Array.isArray(a)?{totalPages:t,totalPosts:s,responseData:a}:new Error(__("Response data is not an array","cm-blocks"))}catch(e){throw e}})(i);if(!Array.isArray(a))return new Error((0,t.__)("Response data is not an array","cm-blocks"));const o=(e=>e.map((e=>{const t=(s=e.title.rendered,(a=document.createElement("textarea")).innerHTML=s,a.value);var s,a;const o=e.acf?.is_premium,l=e.raw_content,r=(0,y.rawHandler)({HTML:l});return{name:"codemanas/cmblocks/api/"+e.slug,title:t,content:l,description:"",categories:["all"],keywords:["codemanas"],blockTypes:["codemanas/cmblocks--api"],blocks:r,premium:o,demo_link:e.link,feature_image_url:e.featured_image_url,id:e.id,type:e.type}})))(a);L(e),K(s),D(o),V(!1),Q(!0)}catch(e){console.error((0,t.__)("Error:","cm-blocks"),e),Q(!1),V(!1)}},Te=async(e=E,t=!1,s="",a="all",o=!1,l=[])=>Ve("posts",e,t,s,a,o,l),Be=async(e=E,t=!1,s="",a="all",o=!1,l=[])=>Ve("pages",e,t,s,a,o,l),Ee=async(e=!1)=>{V(!0);let t=`v2/kits?per_page=6&page=${E}`;je||(F&&(t+=`&search=${F}`),"all"!==A&&A&&(t+=`&category_slug=${A}`),t+=`&filter_by=${"pro"===X?X:"all"}`),e.length>0&&(t+=`&include=${e.join(",")}`);try{const e=await(async e=>{try{const{responseData:t}=await n(e),s=t.terms.map((e=>({id:e.term_id,type:"kits",title:e.name,feature_image_url:e.featured_image,category_id:e.term_id,premium:e.is_premium,category:e.category,description:e.description})));return{total_count:t.total_count,kits:s,total_pages:t.total_pages}}catch(e){throw console.error("Error fetching kits:",e),e}})(t);D(e.kits),K(e.total_count),L(e.total_pages)}catch(e){console.error("Error fetching WordPress categories:",e)}V(!1)},Re=(0,H.debounce)((e=>{I(e)}),1e3),Ze=(0,r.useMemo)((()=>$),[F,$,A]);return(0,r.useEffect)((()=>{w&&N()({path:"/wp/v2/settings"}).then((e=>{te(e.cm_blocks_license_data.status)}))}),[J]),(0,r.useEffect)((()=>{(async()=>{try{const e=await c("v2/categories?per_page=100&exclude=1");de((t=>[...t,...e]))}catch(e){console.error("Error fetching WordPress categories:",e)}})().catch((e=>{console.error(e)})),(async()=>{try{const e=await c("v2/pageCategories");ue((t=>[...t,...e]))}catch(e){console.error("Error fetching WordPress categories:",e)}})().catch((e=>{console.error(e)}))}),[]),(0,r.useEffect)((()=>{if("patterns"===U)if("theme"===A)Se(oe);else if(je){const e=Pe.filter((e=>"post"===e.type)).map((e=>e.object_id));e.length>0?Te(E,!1,"","all",!1,e):D([]),B(!1)}else Te(E,W,F,X,!1).catch((e=>{console.error(e)}));else if("page"===U)if("theme"===A)Se(le);else if(je){const e=Pe.filter((e=>"page"===e.type)).map((e=>e.object_id));e.length>0?Be(E,!1,"","all",!1,e):D([]),B(!1)}else Be(E,W,F,X,!1).catch((e=>{console.error(e)}));else if("kits"===U)if(je){const e=Pe.filter((e=>"kits"===e.type)).map((e=>e.object_id));e.length>0?ge||Ee(e):D([]),B(!1)}else ge||Ee()}),[U,se,W,E,X,A,F,je,ge]),(0,r.useEffect)((()=>{if("patterns"===U&&void 0!==pe){const e=He(pe,oe);ie(e)}else if("page"===U){const e=He(me,le);ie(e)}}),[U,pe,me,oe,le]),(0,i.jsx)(i.Fragment,{children:w&&(0,i.jsx)(l.Modal,{onRequestClose:()=>{u()},title:d,overlayClassName:"block-library-query-pattern__selection-modal",isFullScreen:!0,className:"cmblocks-popup__modal",ref:P,icon:e,children:(0,i.jsxs)("div",{className:"cmblocks-popup__modal-main",children:[!ge&&(0,i.jsx)(k,{onRefreshClick:()=>{ae(!se);const e=document.querySelector(".cmblocks-popup__modal-patterns-refresher-icon svg"),t=e.style.transform;e.style.transform="rotate(360deg)"===t?"rotate(0deg)":"rotate(360deg)",e.style.transition="500ms ease"}}),(ge||je)&&(0,i.jsx)(v,{onGoBackClick:()=>{ge?je?(ke(!1),ye(!0)):(ke(!1),fe(!1)):je&&(ye(!1),z("patterns"),R(1))}}),!ge&&!je&&(0,i.jsx)(f,{onClickFavoriteButton:async()=>{B(!0),ye(!0),z("patterns"),R(1)}}),je&&!ge&&(0,i.jsx)(j,{className:"secondary",options:[{value:"patterns",label:(0,t.__)("Patterns","cm-blocks")},{value:"page",label:(0,t.__)("Page","cm-blocks")},{value:"kits",label:(0,t.__)("Kits","cm-blocks")}],onChange:Me,value:U}),J&&(0,i.jsxs)("div",{className:"cmblocks-popup__modal-inner-wrapper",children:[!je&&(0,i.jsx)(C,{handleFilterChange:e=>{Y(e),R(1)},handleSearchChange:e=>{Re(e),R(1)},handleTabChange:Me,handleCategoryChange:(e,t)=>{R(1),O(e),G(t)},searchValue:F,selectedCategory:A,categories:ce,isKits:ge}),(0,i.jsxs)("div",{className:Ne,children:[S||T?(0,i.jsxs)("div",{className:"cmblocks-popup__modal-patterns-loading",children:[(0,i.jsx)(l.Spinner,{})," ",(0,i.jsx)("span",{className:"cmblocks-popup__modal-patterns-loading-text",children:he})]}):(0,i.jsx)(i.Fragment,{children:Ze.length>0?(0,i.jsx)(i.Fragment,{children:ge?(0,i.jsx)(b,{patterns:$,title:be,isPremium:Ce,description:we,isValidLicense:ee,onClickPattern:(e,t)=>M(e,t,_e,V,0,ee,fetch,x,re,u,s.select,y.isUnmodifiedDefaultBlock,y.rawHandler,a,p)}):(0,i.jsx)(h,{patterns:$,activeTab:U,onClickPattern:(e,t)=>((e,t)=>{if("kits"===U)return Be(1,e.category_id,"","all",!0),ke(!0),ve(e.title),xe(e.description),void(e.premium&&fe(!0));M(e,t,_e,V,0,ee,fetch,x,re,u,s.select,y.isUnmodifiedDefaultBlock,y.rawHandler,a,p)})(e,t),isLoading:S})}):(0,i.jsx)("div",{className:"cmblocks-popup__modal-patterns-no-results",children:(0,t.__)("No results found.","cm-blocks")})}),J&&Ze.length>0&&!S&&!ge&&!T&&(0,i.jsx)(_,{totalPosts:q,totalPages:Z,currentPage:E,onPageChange:e=>{R(e)}})]})]}),!S&&!J&&(0,i.jsx)("div",{className:"cmblocks-popup__modal-message",children:(0,i.jsx)(g,{message:(0,t.__)("Something went wrong - please try again","cm-blocks")})})]})})})}const V=window.wp.editor;(0,a.registerPlugin)("block-importer-toolbar",{render:()=>{const e=()=>{const[e,a]=(0,r.useState)(null),[n,c]=(0,r.useState)(!1),[p,m]=(0,r.useState)(null),{getSelectedBlock:u,getBlockIndex:h,getBlockHierarchyRootClientId:_}=(0,s.useSelect)(o.store);return(0,r.useEffect)((()=>{const e=(0,s.subscribe)((()=>{const e=u();null!==e&&null!==e.clientId&&void 0!==e.clientId&&p!==e.clientId&&m(e.clientId)}),o.store);return()=>{e()}}),[]),(0,i.jsxs)("div",{...(0,o.useBlockProps)(),children:[n&&(0,i.jsx)(d,{children:(0,i.jsx)(S,{index:e,selectedBlockID:p,modalTile:(0,t.__)("Design Library","cm-blocks"),icon:(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 46 47",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 0C4.47715 0 0 4.47715 0 10V37C0 42.5228 4.47715 47 10 47H36C41.5228 47 46 42.5228 46 37V36.8778H42V37C42 40.3137 39.3137 43 36 43H10C6.68629 43 4 40.3137 4 37V10C4 6.68629 6.68629 4 10 4H36.3556C39.4729 4 42 6.5271 42 9.64444H46C46 4.31797 41.682 0 36.3556 0H10ZM9 12H15V18H9V12ZM39 12H33V18H39V12ZM22 17H17V22H22V17ZM26 23H21V28H26V23ZM25 17H30V22H25V17ZM39 30H33V36H39V30ZM33 21H39V27H33V21ZM15 21H9V27H15V21ZM9 30H15V36H9V30Z",fill:"white"})}),isModalOpen:n,closeModal:function(){c(!1),a(null)}})}),(0,i.jsxs)(l.Button,{className:"cmblocks-pattern-importer-button",variant:"primary",onClick:()=>{if(null!==p){const e=_(p);let t=0;t=e?h(e)+1:h(p)+1,a(t)}c(!0)},children:[(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 46 47",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 0C4.47715 0 0 4.47715 0 10V37C0 42.5228 4.47715 47 10 47H36C41.5228 47 46 42.5228 46 37V36.8778H42V37C42 40.3137 39.3137 43 36 43H10C6.68629 43 4 40.3137 4 37V10C4 6.68629 6.68629 4 10 4H36.3556C39.4729 4 42 6.5271 42 9.64444H46C46 4.31797 41.682 0 36.3556 0H10ZM9 12H15V18H9V12ZM39 12H33V18H39V12ZM22 17H17V22H22V17ZM26 23H21V28H26V23ZM25 17H30V22H25V17ZM39 30H33V36H39V30ZM33 21H39V27H33V21ZM15 21H9V27H15V21ZM9 30H15V36H9V30Z",fill:"white"})}),(0,i.jsx)(l.Dashicon,{icon:"plus-alt"})]})]})};return(0,r.useEffect)((()=>{const t=(0,s.subscribe)((()=>{const t=document.querySelector(".edit-post-header-toolbar");t&&!t.querySelector(".cmblocks__block-importer-toolbar")&&(t=>{const s=document.createElement("div");s.classList.add("cmblocks__block-importer-toolbar"),t.appendChild(s),(0,r.render)((0,i.jsx)(e,{}),s)})(t)}));return()=>{t()}}),[]),(0,i.jsx)("div",{children:"Item"})}}),(0,a.registerPlugin)("cm-blocks-template-header-panel",{render:()=>{const[e,a]=(0,r.useState)(!1),{savePost:o}=(0,s.useDispatch)("core/editor"),[n,c]=(0,r.useState)(!1),p=(0,s.useSelect)((e=>{const t=e("core/editor").getEditedPostAttribute("id"),s=e("core").getEditedEntityRecord("postType","wp_template_part",t);return{postType:e("core/editor").getCurrentPostType(),entityRecord:s}}),[]);return(0,r.useEffect)((()=>{if(void 0===p)return;if(void 0===p.postType||null===p.postType)return;if(void 0===p.entityRecord||null===p.entityRecord)return;const{theme:e,slug:s}=p.entityRecord;N()({path:`/cm-blocks/v1/header?slug=${s}&theme=${e}`}).then((e=>{c("1"===e?.option)})).catch((e=>{Error(e.message||(0,t.__)("An unknown error occurred","cm-blocks"))}))}),[p]),(0,i.jsx)(i.Fragment,{children:p.hasOwnProperty("postType")&&null!==p.postType&&"wp_template_part"===p.postType&&p.hasOwnProperty("entityRecord")&&!1!==p.entityRecord&&p.entityRecord.hasOwnProperty("area")&&"header"===p.entityRecord.area&&(0,i.jsx)(V.PluginDocumentSettingPanel,{name:"cm-blocks-header-panel",title:(0,t.__)("CM Blocks Header Options","cm-blocks"),className:"cm-blocks-header-panel",children:(0,i.jsx)(l.PanelRow,{children:(0,i.jsx)(l.ToggleControl,{label:(0,t.__)("Enable Sticky Header","cm-blocks"),onChange:async e=>{await o();const{theme:s,slug:l}=p.entityRecord;a(!0),N()({path:"/cm-blocks/v1/header",method:"POST",data:{slug:l,theme:s,option:e}}).then((t=>{a(!1),c(e)})).catch((e=>console.error(e.message||(0,t.__)("An unknown error occurred","cm-blocks"))))},checked:n})})})})}})})();